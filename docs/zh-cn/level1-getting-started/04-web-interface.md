# 第四章：Web 界面使用指南

## 学习目标

完成本章节学习后，你将能够启动和使用 Web 应用程序进行股票分析，掌握界面各区域的功能和操作方法，理解如何通过可视化界面配置分析参数，以及能够查看和解读分析结果。预计学习时间为 20-40 分钟。

## 4.1 Web 应用概述

Web 应用提供了更直观的图形界面，适合不喜欢命令行的用户。通过 Web 界面，你可以使用鼠标点击完成所有操作，无需记忆复杂的命令行参数。Web 应用还提供了历史记录查看、可视化图表等功能，便于追踪和分析历史决策。

Web 应用采用前后端分离架构。后端使用 FastAPI 框架提供 RESTful API，前端使用现代 JavaScript 框架提供交互式界面。这种架构使得前端可以独立更新和优化，同时也支持 API 方式的程序化访问。

## 4.2 启动 Web 应用

### 前置条件

在启动 Web 应用之前，请确保已完成以下步骤：安装了项目依赖（执行 `poetry install`）；配置了 LLM API 密钥（编辑 `.env` 文件）；安装了 Node.js 和 npm（用于前端）。

### 启动后端服务

首先，启动后端 API 服务。打开一个新的终端窗口，进入项目目录，然后进入 app 目录：

```bash
cd app
```

启动后端服务：

```bash
poetry run uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

启动成功后，你会看到类似以下的输出：

```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Application startup complete
```

### 启动前端开发服务器

打开另一个新的终端窗口，进入 app 目录：

```bash
cd app
```

启动前端服务：

```bash
npm run dev
```

启动成功后，会显示类似以下的信息：

```
VITE v5.0.0  ready in 300 ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

### 访问 Web 界面

打开浏览器，访问 `http://localhost:5173`。如果一切正常，你应该能看到 Web 应用的主界面。

## 4.3 界面布局与功能

### 主界面结构

Web 应用的主界面包含以下几个主要区域：

**顶部导航栏**：包含应用标题、导航菜单和用户设置入口。

**左侧边栏**：提供快捷导航和常用功能入口。

**主内容区**：显示当前页面的主要内容。

**状态栏**：显示系统状态和快捷操作按钮。

### 主要功能区域

**股票输入区**位于主内容区的顶部或左侧，用于输入要分析的股票代码。你可以直接输入股票代码（支持多只股票，用逗号分隔），系统会提供自动补全功能帮助你输入正确的股票代码。

**时间范围选择器**用于设置分析的开始和结束日期。日期选择器支持日期范围选择，可以快速选择常用的时间范围（如最近 30 天、最近 3 个月、最近 1 年）。

**模型选择器**用于选择使用的 LLM 提供商。下拉菜单显示所有已配置的可选模型，选择后会显示当前选择的模型名称。

**智能体选择器**用于选择参与分析的智能体。可以选择「全部智能体」或特定智能体组合。智能体以卡片或列表形式展示，每个智能体显示名称、风格标签和简短描述。

**分析按钮**是主内容区的主要操作按钮，点击后会触发分析流程。按钮在分析进行中会显示加载状态，分析完成后显示完成状态。

**结果展示区**显示分析结果，包括各智能体的分析结果、风险评估和最终建议。结果通常以卡片、表格或图表形式展示，便于比较和理解。

## 4.4 操作流程

### 基本分析流程

使用 Web 应用进行股票分析的基本流程如下：

**第一步：输入股票代码**。在股票输入框中输入要分析的股票代码。例如，输入「AAPL」分析苹果公司，或输入「AAPL,MSFT,NVDA」同时分析多只股票。

**第二步：设置时间范围**。点击日期选择器，选择分析的起止日期。如果不设置，系统会使用默认的最近 30 天数据。

**第三步：选择模型**。从模型下拉菜单中选择要使用的 LLM 提供商。默认使用 OpenAI GPT-4o。

**第四步：选择智能体**。勾选要参与分析的智能体。可以选择全部智能体或特定子集。建议初学者先使用全部智能体，熟悉后再尝试筛选。

**第五步：运行分析**。点击「Run Analysis」或「开始分析」按钮。分析过程可能需要 1-3 分钟，期间可以查看进度信息。

**第六步：查看结果**。分析完成后，结果会显示在结果展示区。可以通过滚动或切换标签查看各部分内容。

### 历史记录查看

Web 应用会自动保存分析历史，方便你回顾之前的分析结果。

**查看历史**：点击左侧边栏的「History」或「历史」标签，进入历史记录页面。

**筛选历史**：可以使用股票代码、时间范围等条件筛选历史记录。

**查看详情**：点击某条历史记录，可以查看完整的分析详情，包括各智能体的原始输出。

**重新运行**：可以基于某条历史记录的配置重新运行分析。

### 图表查看

Web 应用提供了可视化图表帮助你理解分析结果。

**智能体投票图**：显示各智能体的投票结果（买入/卖出/持有），通常以柱状图或饼图形式展示。

**置信度分布图**：展示各智能体置信度的分布情况，帮助理解整体确定性水平。

**时间序列图**：对于历史分析，显示股票价格和系统建议的历史变化。

## 4.5 配置选项

### 用户设置

点击右上角的用户图标或设置入口，可以访问用户配置页面。

**默认模型设置**：设置默认使用的 LLM 模型，下次访问时会自动选择。

**智能体偏好**：设置默认的智能体选择，可以保存常用的智能体组合。

**显示选项**：配置结果的显示方式，如每页显示数量、默认展开状态等。

### 主题设置

Web 应用支持浅色和深色主题。点击主题切换按钮可以在两种主题之间切换。深色主题适合在光线较暗的环境下使用，减少眼睛疲劳。

## 4.6 常见问题与解决

### 问题一：页面无法加载

如果访问 `http://localhost:5173` 时页面无法显示，请按以下步骤排查：

**第一步：检查前端服务**。确认 `npm run dev` 命令正在运行，没有报错或退出。

**第二步：检查后端服务**。确认 `uvicorn` 命令正在运行，端口 8000 没有被其他程序占用。

**第三步：检查浏览器控制台**。打开浏览器开发者工具（F12），查看控制台是否有错误信息。

**第四步：清除浏览器缓存**。尝试清除缓存后重新访问。

### 问题二：分析卡住

如果在运行分析时页面卡住无响应：

**第一步：检查后端日志**。查看运行 `uvicorn` 的终端窗口中的日志输出。

**第二步：检查 API 密钥**。确认 `.env` 文件中的 API 密钥配置正确且有效。

**第三步：尝试刷新页面**。刷新页面后重新运行分析。

**第四步：检查网络连接**。确认网络可以访问 LLM 服务和金融数据 API。

### 问题三：结果不显示

如果分析完成但结果没有显示：

**第一步：检查网络请求**。使用浏览器开发者工具的 Network 标签查看请求是否成功返回。

**第二步：检查数据完整性**。确认返回的数据包含完整的分析结果。

**第三步：尝试不同股票**。如果特定股票出现问题，尝试分析其他股票。

**第四步：查看错误日志**。检查后端日志中是否有错误信息。

## 4.7 练习题

### 练习 4.1：Web 界面基本操作

**任务**：使用 Web 界面完成一次完整的股票分析。

**步骤**：首先启动 Web 应用的前后端服务，然后访问 Web 界面，接着输入股票代码 AAPL 并设置时间范围为最近 3 个月，选择全部智能体运行分析，最后查看并阅读分析结果。

**成功标准**：能够通过 Web 界面完成整个分析流程，能够定位和理解界面各区域的功能。

### 练习 4.2：历史记录使用

**任务**：使用历史记录功能查看之前的分析。

**步骤**：首先运行两次不同股票或不同配置的分析，然后进入历史记录页面，筛选和查找历史记录，查看某条记录的详情，最后基于历史记录重新运行分析。

**成功标准**：能够使用历史记录功能查看、筛选和重新运行历史分析。

### 练习 4.3：配置个性化设置

**任务**：配置个性化的用户偏好设置。

**步骤**：进入用户设置页面，设置默认使用 Anthropic Claude 模型，筛选一组常用的智能体（如价值投资风格），设置深色主题并保存，最后验证设置是否生效。

**成功标准**：能够成功配置和保存用户偏好设置，退出后重新登录设置仍然生效。

---

## 进阶思考

思考以下问题。与命令行相比，Web 界面在用户体验方面有哪些优势和劣势？在团队协作场景中，Web 界面有哪些命令行无法替代的功能？如果需要扩展 Web 应用的功能，你会优先添加哪些功能？

完成 Level 1 的学习后，你可以继续学习 Level 2 的核心概念，深入理解系统的技术原理和工作机制。

---

## 版本信息

| 项目 | 信息 |
|------|------|
| 文档版本 | 1.0.2 |
| 最后更新 | 2026年2月 |
| 适用版本 | 1.0.0+ |

**更新日志**：
- v1.0.2 (2026.02)：更新界面截图说明，增加故障排查步骤
- v1.0.1 (2025.12)：完善历史记录功能说明
- v1.0.0 (2025.10)：初始版本

## 反馈与贡献

如果您在使用过程中发现问题或有改进建议，欢迎通过 GitHub Issues 提交反馈。
